\tikzstyle{line} = [draw, -latex]
\begin{tikzpicture}[rounded corners, text centered]
\tikzstyle{dot} = [circle, draw, fill=black, inner sep=1pt]
  \small
  \node[draw, thick, fill=black!15, text width=6em, minimum height=4.5em] at (0,-2.0) (learn){\bf Learning \\
{\footnotesize $\bs_+ = \bff_m(\bs)$ \\ $\bpsi = \bg(\be,\bu)$}};
  \path[line] (learn.south) -- (0,-3.1) -| (-4.8,-1.0) -- (-2.8,1.0);

  \node[draw, thick, fill=black!15, text width=6em, minimum height=3.5em] at (-3.8,0) (pol){\bf Policy  \\ {\footnotesize $\bu = \bpi(\bx)$}};
  \node[draw, thick, fill=black!30, text width=6em, minimum height=4.5em] at (0,0) (sys){\bf System \\ {\footnotesize $\bx_+ = \bff(\bx,\bu)$}};

  
  \node[dot] at (-2,0) (dot1){};
  \node[dot] at (2,0) (dot2){};

  \path[draw] (sys.east) -- (dot2);
  \path[line] (dot1) |- (learn.west);
  \path[line] (dot2) |- (learn.east);
  \path[line] (dot2) |- (-5.6,1.4) |- (pol.west);
  \path[line] (pol.east) -- (sys.west);

  \node at (1.6,0.2) {$\bx$};
  \node at (-2,0.2) {$\bu$};
  \node at (-4.4,-2.8) {$\bpsi$};

\end{tikzpicture}
