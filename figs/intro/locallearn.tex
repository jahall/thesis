\tikzstyle{line} = [draw, -latex]
\tikzstyle{sum} = [thick,circle, draw, minimum height=.4cm]
\tikzstyle{dot} = [circle, draw, fill=black, inner sep=1pt]
\begin{tikzpicture}[rounded corners, text centered]
  \small
  \node[draw, fill=black!15, thick, text width=6em, minimum height=3.5em] at (0,-3.6) (pilco){{\small Local Policy} \bf Learning};
  \path[line] (pilco.west) -| (-5.8,-1.0) -- (-3.8,1.0);

  \node[draw, thick, fill=black!15, text width=6em, minimum height=3.5em] at (-4.8,0) (pol){\bf Policy  \\ {\footnotesize $\delta\bu = \bpi(\delta\bx)$}};
  \node[draw, thick, fill=black!30, text width=6em, minimum height=4.5em] at (0,0) (sys){\bf System \\ {\footnotesize $\bx_+ = \bff(\bx,\bu)$}};
  \node[draw, thick, fill=black!15, text width=6em, minimum height=3.5em] at (0,-1.8) (GP){\bf Model \\ {\footnotesize $p(\bw|\cD)$ }};
  
  \node[dot] at (-2,0) (dot1){};
  \node[dot] at (2,0) (dot2){};
  \node[sum] at (-6.5,0) (sum1){};
  \node[sum] at (-3.1,0) (sum2){};

  \path[draw] (sys.east) -- (dot2);
  \path[line] (dot2) |- (-6.5,1.3) -- (sum1.north);
  \path[line] (sum1.east) -- (pol.west);
  \path[line] (pol.east) -- (sum2.west);
  \path[line] (sum2.east) -- (sys.west);
  \path[line] (dot1) |- (GP.west);
  \path[line] (dot2) |- (GP.east);
  \path[line] (GP.south) -- (pilco.north);
  \path[line] ([yshift=0.15cm]pilco.west) -| (sum2.south);
  \path[line] ([yshift=-0.15cm]pilco.west) -| (sum1.south);

  \node at (1.6,0.2) {$\bx$};
  \node at (-2,0.2) {$\bu$};
  \node at (-6.2,-3.55) {$\bar\bx$};
  \node at (-2.8,-3.25) {$\bar\bu$};
  %\node at (0.6,-2.85) {$\EE[\bw]$};
  \node at (-5.4,-3.35) {$\bpsi$};
  \node at (-6.8,-0.3) {$-$};

\end{tikzpicture}
